<div id="template-fields-container" class="grid grid-cols-1 gap-6 sm:gap-8">
  <p>Topic ID: <%= params[:based_on_topic] %></p>
  <p>Field Values: <%= field_values.inspect %></p>
  <% @template_fields.each do |field| %>
    <% value = field_values[field.id] %>

    <p>Template Field ID: <%= field.id %></p>
    <p>Value Object: <%= field_values[field.id].inspect %></p>

    <div class="flex flex-col group">

      <%= label_tag "fields_#{field.id}",
      field.label,
      class:
        "block text-xs sm:text-sm font-bold text-gray-700 uppercase tracking-wide mb-2",
      title: field.hint %>

      <% if field.hint.present? %>
        <p class="text-xs text-gray-400 mb-2 leading-normal whitespace-pre-line"><%= field.hint %></p>
      <% end %>

      <% case field.field_type %>
      <% when "shorttext" %>
        <%= text_field_tag "fields[#{field.id}]",
        value,
        class: input_classes,
        placeholder: "Enter #{field.label.downcase}...",
        required: true,
        autocomplete: "off" %>

      <% when "textarea" %>
        <%= text_area_tag "fields[#{field.id}]",
        value,
        class:
          "#{input_classes} min-h-[120px] sm:min-h-[150px] resize-y leading-relaxed",
        placeholder: "Enter details...",
        required: true %>

      <% when "dropdown" %>
        <div class="relative">
          <% options = field.option_list %>
          <%= select_tag "fields[#{field.id}]",
          options_for_select(options, value),
          prompt: "Select an option",
          class: "#{input_classes} appearance-none pr-10 cursor-pointer",
          required: true %>
          <div
            class="
              absolute inset-y-0 right-0 flex items-center px-4 pointer-events-none
              text-gray-500
            ">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M19 9l-7 7-7-7" /></svg>
          </div>
        </div>

      <% when "radio" %>
        <div class="mt-2 space-y-3 pl-1">
          <% options = field.option_list %>
          <% options.each_with_index do |option, idx| %>
            <div class="flex items-center">
              <%= radio_button_tag "fields[#{field.id}]",
              option,
              (value == option),
              id: "field_#{field.id}_#{idx}",
              required: true,
              class:
                "w-4 h-4 sm:w-5 sm:h-5 text-blue-600 border-gray-300 focus:ring-blue-500 cursor-pointer" %>
              <%= label_tag "field_#{field.id}_#{idx}",
              option,
              class:
                "ml-3 block text-sm sm:text-base font-medium text-gray-700 cursor-pointer hover:text-gray-900" %>
            </div>
          <% end %>
        </div>

      <% else %>
        <%= text_field_tag "fields[#{field.id}]", value, class: input_classes, required: true, autocomplete: "off" %>
      <% end %>
    </div>
  <% end %>
</div>